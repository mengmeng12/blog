<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/blog/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/blog/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/blog/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="projects,economics,codes,finance,python,thesis,NS model," />





  <link rel="alternate" href="/blog/atom.xml" title="Shuchen Meng's Blog" type="application/atom+xml" />






<meta name="description" content="My undergraduate thesis: Analysis of the characteristics of China’s national debt yield curve and macroeconomic variables">
<meta name="keywords" content="projects,economics,codes,finance,python,thesis,NS model">
<meta property="og:type" content="article">
<meta property="og:title" content="Undergraduate Thesis Analysis of the characteristics of China&#39;s national debt yield curve and macroeconomic variables">
<meta property="og:url" content="mengmeng12.github.io/blog/2020/01/06/undergraduate_thesis/index.html">
<meta property="og:site_name" content="Shuchen Meng&#39;s Blog">
<meta property="og:description" content="My undergraduate thesis: Analysis of the characteristics of China’s national debt yield curve and macroeconomic variables">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://i1.fuimg.com/640680/6d96936fd5491bcd.png">
<meta property="og:image" content="http://i1.fuimg.com/640680/96f9bb754b4baa6d.png">
<meta property="og:image" content="http://i1.fuimg.com/640680/9c70e4a79132e1d8.png">
<meta property="og:image" content="http://i1.fuimg.com/640680/7cb7e7fa205bbe86.png">
<meta property="og:image" content="http://i1.fuimg.com/640680/4d23bd9dab004f4d.png">
<meta property="og:image" content="http://i1.fuimg.com/640680/2e86a67e24ca368b.png">
<meta property="og:image" content="http://i1.fuimg.com/640680/e15fad6dd85a6981.png">
<meta property="og:image" content="http://i1.fuimg.com/640680/9d9ec9b310182d91.png">
<meta property="og:image" content="http://i1.fuimg.com/640680/efa3552937640d34.png">
<meta property="og:image" content="http://i1.fuimg.com/640680/04f6fe4e8656b0ac.png">
<meta property="og:image" content="http://i1.fuimg.com/640680/eb160f9909e4c73f.png">
<meta property="og:image" content="http://i1.fuimg.com/640680/f56503392a6d8b6c.gif">
<meta property="og:image" content="http://i1.fuimg.com/640680/088fee22c8df4ee8.png">
<meta property="og:updated_time" content="2020-01-12T05:03:29.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Undergraduate Thesis Analysis of the characteristics of China&#39;s national debt yield curve and macroeconomic variables">
<meta name="twitter:description" content="My undergraduate thesis: Analysis of the characteristics of China’s national debt yield curve and macroeconomic variables">
<meta name="twitter:image" content="http://i1.fuimg.com/640680/6d96936fd5491bcd.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="mengmeng12.github.io/blog/2020/01/06/undergraduate_thesis/"/>





  <title>Undergraduate Thesis Analysis of the characteristics of China's national debt yield curve and macroeconomic variables | Shuchen Meng's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <a href="https://github.com/mengmeng12"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub"></a>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Shuchen Meng's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Economics & Economist</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/blog/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/blog/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/blog/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="mengmeng12.github.io/blog/blog/2020/01/06/undergraduate_thesis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Shuchen Meng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shuchen Meng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Undergraduate Thesis Analysis of the characteristics of China's national debt yield curve and macroeconomic variables</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T16:59:19-05:00">
                2020-01-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/projects/" itemprop="url" rel="index">
                    <span itemprop="name">projects</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/blog/2020/01/06/undergraduate_thesis/" class="leancloud_visitors" data-flag-title="Undergraduate Thesis Analysis of the characteristics of China's national debt yield curve and macroeconomic variables">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  443
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  3
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>My undergraduate thesis: <strong>Analysis of the characteristics of China’s national debt yield curve and macroeconomic variables</strong></p>
<a id="more"></a>
<p><strong>Abstract</strong><br>Treasury yield curve describes the yield of Treasury bonds with different maturities and the relationship between them. It is generally believed that in an effective financial market, the Treasury yield curve contains abundant economic information, which is of great significance to both micro-economic and macro-economic. In this article, through <strong>Nelson-Siegel-Svensson</strong> model, China and the United States<br>Treasuries yield curve structures were estimated, and then were showed by the three-dimensional figure.<br>Compared the descriptive statistics relative to the United States, China’s inter-bank bond yield curve short term interest rate fluctuation is bigger, and more discrete, medium and long-term yield spreads are much smaller than in the us. After that, principal component analysis was carried out, and it was clear that horizontal factor, slope factor and curvature factor were the main influencing factors of yield curve characteristics, and the relationship between principal component and macroeconomic variables was<br>further explored. The level factor contains the inflation information, the slope factor can reflect the market<br>participant’s confidence and the anticipated change, the yield curve characteristic reflects quicker than the<br>money supply response to the monetary policy. Finally, the characteristics of the bond yield curve are<br>recognized. This paper believes that only by enriching the bond varieties and stimulating the vitality of<br>the bond market, can the bond market further play the role of interest rate discovery.</p>
<h2 id="presentation"><a href="#presentation" class="headerlink" title="presentation"></a>presentation</h2>

	<div class="row">
		<iframe src="https://drive.google.com/file/d/1ZLs6NUBCLN-taboF5ftbfm_os05nSyS3/preview" style="width:100%; height:550px"></iframe>
	</div>



<h2 id="thesis"><a href="#thesis" class="headerlink" title="thesis"></a>thesis</h2>

	<div class="row">
    <embed src="https://mengmeng12.github.io/blog/undergrad_thesis.pdf" width="100%" height="550" type="application/pdf">
	</div>



<h2 id="Some-work-details"><a href="#Some-work-details" class="headerlink" title="Some work details"></a>Some work details</h2><p>This <a href="https://github.com/mengmeng12/Nelson-Siegel-model/tree/master" target="_blank" rel="noopener">repo</a> contains codes for my undergraduate thesis. </p>
<p>I found that there are some NS/NSS model implementation in python/R/matlab. Some models rate and maturity, some like QuantLib allows users model price and maturity. The jupyter notebook and R markdown will make it easier for a naive user to learn to run and use the model.</p>
<p>There are some requirements like Quantlib and fbonds package. Although not listed together, you can find the instruction of how to install them.</p>
<p>Some other analysis including PCA and a 3D+contour plot. You can also find the plot settings in figure_template.py quite useful.</p>
<p>Some codes are not the final version cause I wrote some codes in my girl friend’s mac. All the codes can be run by a simple beginner :-D</p>
<h3 id="NS-NSS-model-optimization"><a href="#NS-NSS-model-optimization" class="headerlink" title="NS/NSS model optimization"></a>NS/NSS model optimization</h3><p>we have fbonds in R and quantlib in python taking both rate and price as input to estimate term structure.</p>
<ul>
<li>Term structure optimized by fbonds in R. Using rate as input<br><img src="http://i1.fuimg.com/640680/6d96936fd5491bcd.png" alt="NSS 3D"></li>
</ul>
<p><img src="http://i1.fuimg.com/640680/96f9bb754b4baa6d.png" alt="Markdown"></p>
<h3 id="PCA-analysis"><a href="#PCA-analysis" class="headerlink" title="PCA analysis"></a>PCA analysis</h3><ul>
<li>Loadings of PCA</li>
</ul>
<p><img src="http://i1.fuimg.com/640680/9c70e4a79132e1d8.png" alt="Markdown"></p>
<ul>
<li>PCA ind arrow plot<br><img src="http://i1.fuimg.com/640680/7cb7e7fa205bbe86.png" alt="Markdown"></li>
</ul>
<p><img src="http://i1.fuimg.com/640680/4d23bd9dab004f4d.png" alt="Markdown"></p>
<p><img src="http://i1.fuimg.com/640680/2e86a67e24ca368b.png" alt="Markdown"></p>
<ul>
<li>screen plot<br><img src="http://i1.fuimg.com/640680/e15fad6dd85a6981.png" alt="Markdown"></li>
</ul>
<h3 id="Visualization"><a href="#Visualization" class="headerlink" title="Visualization"></a>Visualization</h3><ul>
<li>PCA year/month plot</li>
</ul>
<p><img src="http://i1.fuimg.com/640680/9d9ec9b310182d91.png" alt="Markdown"></p>
<p><img src="http://i1.fuimg.com/640680/efa3552937640d34.png" alt="Markdown"></p>
<ul>
<li>tSNE-plot<br><img src="http://i1.fuimg.com/640680/04f6fe4e8656b0ac.png" alt="Markdown"></li>
</ul>
<ul>
<li>3D plot</li>
</ul>
<p><img src="http://i1.fuimg.com/640680/eb160f9909e4c73f.png" alt="Markdown"></p>
<p><img src="http://i1.fuimg.com/640680/f56503392a6d8b6c.gif" alt="Markdown"></p>
<ul>
<li>rate distribution<br><img src="http://i1.fuimg.com/640680/088fee22c8df4ee8.png" alt="Markdown"></li>
</ul>

      
    </div>
    
    
    

    

    <div>
    
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-----The ---- end ----<i class="fa fa-paw"></i>--- Thanks --- for --- Reading----</div>
    
</div>

    
    </div>

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/blog/tags/projects/" rel="tag"><i class="fa fa-tag"></i> projects</a>
          
            <a href="/blog/tags/economics/" rel="tag"><i class="fa fa-tag"></i> economics</a>
          
            <a href="/blog/tags/codes/" rel="tag"><i class="fa fa-tag"></i> codes</a>
          
            <a href="/blog/tags/finance/" rel="tag"><i class="fa fa-tag"></i> finance</a>
          
            <a href="/blog/tags/python/" rel="tag"><i class="fa fa-tag"></i> python</a>
          
            <a href="/blog/tags/thesis/" rel="tag"><i class="fa fa-tag"></i> thesis</a>
          
            <a href="/blog/tags/NS-model/" rel="tag"><i class="fa fa-tag"></i> NS model</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/blog/2020/01/05/hello_world/" rel="next" title="Hello World">
                <i class="fa fa-chevron-left"></i> Hello World
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/blog/2020/01/08/bigdata/" rel="prev" title="Using machine learning for stock prediction">
                Using machine learning for stock prediction <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/blog/images/avatar.png"
                alt="Shuchen Meng" />
            
              <p class="site-author-name" itemprop="name">Shuchen Meng</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/blog/archives/">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/blog/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/blog/tags/index.html">
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/blog/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/mengmeng12" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:scmeng19@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          
        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#presentation"><span class="nav-number">1.</span> <span class="nav-text">presentation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#thesis"><span class="nav-number">2.</span> <span class="nav-text">thesis</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Some-work-details"><span class="nav-number">3.</span> <span class="nav-text">Some work details</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NS-NSS-model-optimization"><span class="nav-number">3.1.</span> <span class="nav-text">NS/NSS model optimization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PCA-analysis"><span class="nav-number">3.2.</span> <span class="nav-text">PCA analysis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Visualization"><span class="nav-number">3.3.</span> <span class="nav-text">Visualization</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        
<div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Shuchen Meng</span>

  
</div>



  <span class="post-meta-divider">|</span>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共2.6k字</span>
</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  



  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/blog/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/blog/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("klOjl0RBA8qP5IKgIXkOszBr-gzGzoHsz", "rCaN5wX4mjiRkRMzP95g7XHz");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

  
</body>
</html>
